# Когда стоит задуматься о разделении монолита?
- Стало дорого масштабировать систему
- Очень дорого падать целиком
# Когда стоит задуматься о сервисах изначально?
- Различные заказчики (уникальные циклы бинес процессов)
- Отдельные части системы должны масштабироваться по своим правилам
- Различные технологии для разных сервисов
- Частичная деградация системы (если правильно приготовить)

# Архитектура? Архитектура...
## Модульный монолит
### Что такое?
- Единый солюшен
- Монолитное приложение
- Почти всегда нужен DDD
- Четкая иерархия между модулями
### Почему хорошо?
- Быстро разрабатывать
- Относительно легко разделить на сервисы
- Общая кодовая база - проще процессы
- Можно удерживать сложность в узде
- Нужен один синьор на первое время, затем можно обойтись командой с маленьким опытом
- Можно лететь без k8s, docker и прочего
### Почему плохо?
- Если падает, то падает весь
- Нельзя масштабировать отдельные части системы
- Единый релиз
- Приложение может стать очень большим (сложно понимать)
### Где такое посмотреть?
- todo - нужно поискать нормальные примеры
## Распределенный монолит
- Части системы распределены по отдельным сервисам
- Части системы имеют высокую связанность
- Http/RPC вызовы отдельных частей системы вместо вызовов методов напрямую
## Асинхронный монолит
- Может быть частично асинхронным
- Вместо RPC вызова фигурирует явная публикация в топик с конкретным именем метода
- Скорее всего нет DDD (и без него норм)
- Части системы знают друг о друге
## Service oriented (SOA)
- Слабосвязанные части системы выносят в отдельные сервисы
- Сервис может выполнять несколько операций
- Сервис скрывает логику своей работы
- Сервис предоставляет контракт 
## Микросервисы
### Что такое?
- Подвид SOA
- Более строгие требования к определению зоны ответсвенности сервиса
- Никто толком не знает когда заканчивается "микро-"
- Трудно разделить, построить и удерживать в порядке
### Какие плюсы (если все правильно приготовлено)?
- Модно
- Относительно легко развивать
- Контролируемая сложность с течением времени
- Независимо деплоится
- Может поддерживатся небольшой командой (правило 2 коробок пиццы)
- Относительно быстро можно все выкинуть и переделать правильно
## Акторная модель
### Зачем?
- когда падение части системы это нормальная бизнес логика
- если нужен realtime
- возможно, стоит рассмотреть при построении мессенджеров, CRM систем и трейдинга
- когда задача раскладывается на actor-ы (не для любой предметной области)
### Что такое?
- код рассматривается как изолированная единица работы
- каждая единица работы обладает собственным состоянием
- коммуникации между акторами четко определены
- в один момент времени конкретный актор работает над одной задачей (или не работает)
## Наносервисы
- частный случай микросервисов
- выполняют только одну задачу
- в качестве примера можно рассмотреть azure function или aws lambda

## Асинхронная архитектура

### Особенности
- Сервисы не связаны друг с другом
- Коммуникации происходят через очереди сообщений
- Консьюмеры отделены от продьюсеров и нет никакого хардкода в сообщениях

### В чем сложности
- Придется использовать DDD
- Дорого!
- Распределенный стримминг сбытий
- Схемы данных
- Дедлоки
- Консистентность данных сложно поддерживать

### Использование
#### Стоит внедрять
- В системе изначально изолированные домены
- В системе изолированные бизнес-процессы

#### Не стоит внедрять
- Очень ограниченный бюджет
- Нет экспертизы (нет синьоров в команде)
- Есть подозрение что проект никогда не станет большим